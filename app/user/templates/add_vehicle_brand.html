{% extends "base.html" %}
{% block title %}Manage Brands{% endblock %}

{% block content %}
<h2>Manage Vehicle Brands</h2>

<!-- Add/Edit Brand Form -->
<div class="brand-form-card">
    <h3>{% if form.instance.id %}Edit Brand{% else %}Add New Brand{% endif %}</h3>
    <form id="brandForm" method="POST">
        {% csrf_token %}
        <div class="form-field">
            {{ form.name.label_tag }}
            {{ form.name }}
            {% if form.name.errors %}
                <div class="error">{{ form.name.errors }}</div>
            {% endif %}
        </div>
        <div class="button-group">
            <button type="submit" class="form-btn btn-submit">
                {% if form.instance.id %}Update Brand{% else %}Add Brand{% endif %}
            </button>
            <button type="button" class="form-btn btn-back" 
                onclick="window.location.href='{% url 'view_vehicles' %}'">
                Back to Vehicles
            </button>
            {% if form.instance.id %}
            <button type="button" class="form-btn btn-cancel" 
                onclick="window.location.href='{% url 'add_vehicle_brand' %}'">
                Cancel
            </button>
            {% endif %}
        </div>
    </form>
</div>

<!-- Brands Table -->
<h3>Existing Brands</h3>
<table border="1" cellpadding="8" cellspacing="0" width="100%">
    <thead>
        <tr>
            <th>SR.No</th>
            <th>Brand Name</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for brand in brands %}
        <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ brand.name }}</td>
            <td>
                {% if perms.user.change_vehiclebrand %}
                <a href="{% url 'edit_vehicle_brand' brand.id %}" class="action-btn edit-btn">Edit</a>
                {% endif %}
                {% if perms.user.delete_vehiclebrand %}
                <button class="action-btn delete-btn" 
                        onclick="showConfirmPopup('Are you sure you want to delete this brand?', function(){
                            window.location.href='{% url 'delete_vehicle_brand' brand.id %}';
                        })">
                    Delete
                </button>
                {% endif %}
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="3" style="text-align: center;">No brands found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<style>
/* Table styling */
table { border-collapse: collapse; margin-top: 15px; width: 100%; }
th, td { text-align: left; padding: 10px; }
th { background-color: #f2f2f2; }
tr:nth-child(even) { background-color: #f9f9f9; }

/* Form fields styling */
.form-field {
    margin-bottom: 15px;
    text-align: left;
}
.form-field label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: #333;
}
.form-field input, .form-field select, .form-field textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 14px;
    box-sizing: border-box;
    transition: border-color 0.3s;
}
.form-field input:focus, .form-field select:focus, .form-field textarea:focus {
    border-color: #28a745;
    outline: none;
}

/* Brand form card */
.brand-form-card {
    background-color: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}
.brand-form-card h3 {
    margin: 0 0 15px;
    font-size: 16px;
    color: #333;
}

/* Buttons */
.form-btn {
    padding: 12px 20px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    margin-right: 10px;
    transition: background-color 0.3s;
}
.btn-submit { background-color: #28a745; color: #fff; }
.btn-submit:hover { background-color: #218838; }
.btn-back { background-color: #6c757d; color: #fff; }
.btn-back:hover { background-color: #5a6268; }
.btn-cancel { background-color: #ffc107; color: #fff; }
.btn-cancel:hover { background-color: #e0a800; }
.action-btn { 
    padding: 8px 15px;
    border-radius: 6px;
    font-size: 14px; 
    color: #fff; 
    text-decoration: none; 
    cursor: pointer; 
    display: inline-block; 
    margin-right: 5px;
}
.edit-btn { background-color: #007bff; }
.edit-btn:hover { background-color: #0056b3; }
.delete-btn { background-color: #dc3545; border: none; }
.delete-btn:hover { background-color: #c82333; }

/* Error messages */
.error {
    color: #dc3545;
    font-size: 12px;
    margin-top: 5px;
}

/* Responsive */
@media screen and (max-width: 500px) {
    .form-btn, .action-btn { font-size: 12px; padding: 10px; }
    .form-field input, .form-field select, .form-field textarea { font-size: 14px; padding: 10px; }
    table, th, td { font-size: 14px; }
    .brand-form-card { padding: 15px; }
}
</style>
{% endblock %}